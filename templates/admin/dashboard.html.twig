{% extends '@EasyAdmin/page/content.html.twig' %}

{% block content_title %}Tableau de Bord{% endblock %}

{% block main %}
<div class="row">
    <div class="col-md-6">
        <div class="card" style="padding: 20px; margin-bottom: 20px;">
            <h3>ðŸ“Š Ã‰tat des Capsules</h3>
            <div style="height: 300px; position: relative;">
                <canvas id="capsuleChart"></canvas>
            </div>
        </div>
    </div>

    <div class="col-md-6">
        <div class="card" style="padding: 20px; margin-bottom: 20px;">
            <h3>ðŸ‘¥ Ã‰tat des Utilisateurs</h3>
            <div style="height: 300px; position: relative;">
                <canvas id="userChart"></canvas>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
    // --- GRAPHIQUE 1 : CAPSULES ---
    const ctxCapsule = document.getElementById('capsuleChart');
    new Chart(ctxCapsule, {
        type: 'bar',
        data: {
            labels: ['EnvoyÃ©es', 'En attente'],
            datasets: [{
                label: 'Nombre de Capsules',
                data: [{{ capsules_sent }}, {{ capsules_wait }}],
                backgroundColor: ['#36A2EB', '#FFCE56']
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false, // ðŸ‘ˆ IMPORTANT : Permet d'Ã©craser le graph pour qu'il rentre dans les 300px
            scales: { y: { beginAtZero: true } }
        }
    });

    // --- GRAPHIQUE 2 : UTILISATEURS ---
    const ctxUser = document.getElementById('userChart');
    new Chart(ctxUser, {
        type: 'doughnut',
        data: {
            labels: ['VÃ©rifiÃ©s', 'Non VÃ©rifiÃ©s'],
            datasets: [{
                label: 'Utilisateurs',
                data: [{{ users_verified }}, {{ users_unverified }}],
                backgroundColor: ['#4BC0C0', '#FF6384'],
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false // ðŸ‘ˆ C'est Ã§a qui empÃªche le rond de devenir gÃ©ant !
        }
    });
</script>
{% endblock %}
